<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:models="using:NVIDIA_Profil_Toogler"
        xmlns:local="clr-namespace:NVIDIA_Profil_Toogler"
        mc:Ignorable="d" d:DesignWidth="750" d:DesignHeight="480"
        x:Class="NVIDIA_Profil_Toogler.MainWindow"
        x:DataType="local:MainWindow"
        Icon="/Assets/ico.ico"
        Title="NVIDIA Profil Toogler"
        Width="750"
        Height="480"
        CanResize="False">
    <Window.Resources>
        <models:PercentageConverter x:Key="PercentageConverter" />
    </Window.Resources>
    <Grid>
        <!-- Main Content -->
        <Border Name="MainContentBorder" Background="#FF282828" BorderBrush="#FF505050" BorderThickness="1" CornerRadius="8" Padding="15" Margin="10">
            <DockPanel>
                <Grid ColumnDefinitions="*,Auto" DockPanel.Dock="Top" Margin="0,0,0,10">
                    <TextBlock Text="Profiles" FontSize="16" FontWeight="Bold" VerticalAlignment="Center" />
                    <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                        <Button Name="SetHotkeyButton" Content="âŒ¨ï¸" Padding="0" FontSize="18" />
                        <Button Name="SettingsButton" Content="âš™ï¸" Padding="0" FontSize="18" />
                        <Button Name="AddProfileButton" Content="âž•" Padding="0" FontSize="18" />
                    </StackPanel>
                </Grid>

                <ListBox Name="ProfileListBox" ItemsSource="{Binding ProfileViewModels}">
                    <ListBox.Styles>
                        <Style Selector="ListBoxItem">
                            <Setter Property="Template">
                                <ControlTemplate x:DataType="models:ProfileViewModel">
                                    <Border Name="root" Background="#FF363636" CornerRadius="8" Padding="10" Margin="0,4" BorderBrush="#FF555555" BorderThickness="1"
                                            Classes.Applied="{Binding IsApplied}">
                                        <ContentPresenter Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter>
                        </Style>
                        <Style Selector="ListBoxItem:pointerover /template/ Border#root">
                            <Setter Property="Background" Value="#FF4F4F4F"/>
                        </Style>
                        <Style Selector="Border#root.Applied">
                            <Setter Property="BorderBrush" Value="Orange"/>
                        </Style>
                    </ListBox.Styles>
                    <ListBox.ItemTemplate>
                        <DataTemplate x:DataType="models:ProfileViewModel">
                            <Grid ColumnDefinitions="*,Auto" HorizontalAlignment="Stretch">
                                <StackPanel Grid.Column="0" Orientation="Vertical" Spacing="5">
                                    <TextBlock Text="{Binding Profile.Name}" FontWeight="Bold" />
                                    <StackPanel Orientation="Horizontal" Spacing="5">
                                        <Border Background="#FF444444" CornerRadius="4" Padding="6,3">
                                            <TextBlock Opacity="0.8"><Run Text="ðŸŒˆ"/><Run Text="{Binding Profile.Vibrance}"/></TextBlock>
                                        </Border>
                                        <Border Background="#FF444444" CornerRadius="4" Padding="6,3">
                                            <TextBlock Opacity="0.8"><Run Text="â˜€ï¸"/><Run Text="{Binding Profile.Brightness, StringFormat='{}{0:F2}'}"/></TextBlock>
                                        </Border>
                                        <Border Background="#FF444444" CornerRadius="4" Padding="6,3">
                                            <TextBlock Opacity="0.8"><Run Text="ðŸŒ—"/><Run Text="{Binding Profile.Contrast, StringFormat='{}{0:F2}'}"/></TextBlock>
                                        </Border>
                                        <Border Background="#FF444444" CornerRadius="4" Padding="6,3">
                                            <TextBlock Opacity="0.8"><Run Text="âœ¨"/><Run Text="{Binding Profile.Gamma, StringFormat='{}{0:F2}'}"/></TextBlock>
                                        </Border>
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5" VerticalAlignment="Center">
                                    <Button Content="â–¶ï¸" Click="ApplyProfileButton_Click" Tag="{Binding Profile}" Padding="0" FontSize="18" />
                                    <Button Content="âœï¸" Click="EditProfileButton_Click" Tag="{Binding}" Padding="0" FontSize="18"/>
                                    <Button Content="ðŸ—‘ï¸" Click="DeleteProfileButton_Click" Tag="{Binding}" Padding="0" FontSize="18"/>
                                </StackPanel>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

            </DockPanel>
        </Border>

        <!-- Profile Editor Panel (Overlay) -->
        <Border Name="ProfileEditorPanel"
                IsVisible="False"
                Background="#FF282828" BorderBrush="#FF505050" BorderThickness="1" CornerRadius="8" Padding="15" Margin="10"
                x:DataType="models:Profile">
            <DockPanel>
                <!-- Bottom Buttons -->
                <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10" Margin="0,15,0,0">
                    <Button Name="SaveProfileButton" Content="Save"/>
                    <Button Name="CancelProfileEditButton" Content="Cancel"/>
                </StackPanel>

                <!-- Editor Fields -->
                <StackPanel Spacing="5">
                    <TextBlock Text="Profile Name"/>
                    <TextBox Text="{Binding Name}"/>

                    <Grid ColumnDefinitions="*,Auto" Margin="0,5,0,0">
                        <TextBlock Grid.Column="0" Text="ðŸŒˆ Digital Vibrance" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Text="{Binding Vibrance}" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                    </Grid>
                    <Slider Minimum="0" Maximum="100" Value="{Binding Vibrance}"/>

                    <Grid ColumnDefinitions="*,Auto" Margin="0,5,0,0">
                        <TextBlock Grid.Column="0" Text="â˜€ï¸ Brightness" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Text="{Binding Brightness, StringFormat='{}{0:F2}'}" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                    </Grid>
                    <Slider Minimum="0" Maximum="100" Value="{Binding Brightness, Converter={StaticResource PercentageConverter}}"/>

                    <Grid ColumnDefinitions="*,Auto" Margin="0,5,0,0">
                        <TextBlock Grid.Column="0" Text="ðŸŒ— Contrast" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Text="{Binding Contrast, StringFormat='{}{0:F2}'}" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                    </Grid>
                    <Slider Minimum="0" Maximum="100" Value="{Binding Contrast, Converter={StaticResource PercentageConverter}}"/>

                    <Grid ColumnDefinitions="*,Auto" Margin="0,5,0,0">
                        <TextBlock Grid.Column="0" Text="âœ¨ Gamma" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Text="{Binding Gamma, StringFormat='{}{0:F2}'}" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                    </Grid>
                    <Slider Minimum="0" Maximum="280" Value="{Binding Gamma, Converter={StaticResource PercentageConverter}}"/>
                </StackPanel>
            </DockPanel>
        </Border>


        <Popup Name="SettingsPopup" IsOpen="False" PlacementTarget="{Binding #SettingsButton}" Placement="Bottom">
            <Border BorderBrush="#FF606060" BorderThickness="1" Background="#FF282828" Padding="15" CornerRadius="8">
                <StackPanel Spacing="10">
                    <CheckBox Name="StartWithWindowsCheckBox" Content="Start with Windows" />
                    <CheckBox Name="StartHiddenToTrayCheckBox" Content="Start Hidden" />
                    <CheckBox Name="HideOnCloseCheckBox" Content="Hide on close" />
                    <TextBlock Text="Quick Apply Display:" />
                    <ListBox Name="DisplayListBox">
                        <ListBox.ItemTemplate>
                            <DataTemplate x:DataType="models:DisplayItem">
                                <CheckBox Content="{Binding Name}" IsChecked="{Binding IsSelected}" />
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                        <Button Name="SaveSettingsButton" Content="Save" />
                        <Button Name="CloseSettingsButton" Content="Close" />
                    </StackPanel>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</Window>